{"cells":[{"cell_type":"code","source":["# mount drive\n","from google.colab import drive\n","drive.mount('/gdrive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7EeEhonfJcg5","executionInfo":{"status":"ok","timestamp":1682203367300,"user_tz":-330,"elapsed":22892,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"ab16b12b-c448-410b-b0c9-fcf189b35810"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /gdrive\n"]}]},{"cell_type":"code","source":["# load files\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final/labels_train_efn.csv' '/content'\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final/cluster_centers_train_efn.csv' '/content'\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final/embeddings_train_efn.csv' '/content'"],"metadata":{"id":"7oLR-04_JpgS","executionInfo":{"status":"ok","timestamp":1682203388057,"user_tz":-330,"elapsed":18738,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","execution_count":3,"metadata":{"id":"1ejNRMHcwfMW","executionInfo":{"status":"ok","timestamp":1682203388058,"user_tz":-330,"elapsed":59,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["# import libraries\n","import numpy as np"]},{"cell_type":"code","source":["# load train set clustering labels\n","labels=np.loadtxt('labels_train_efn.csv',delimiter=',')\n","print(labels.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5iSuhPYVxdYV","executionInfo":{"status":"ok","timestamp":1682203388060,"user_tz":-330,"elapsed":58,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"2dc755bc-5224-4785-c5aa-f51714844769"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["(49984,)\n"]}]},{"cell_type":"code","source":["# load train set cluster centers\n","cluster_centers=np.loadtxt('cluster_centers_train_efn.csv',delimiter=',')\n","print(cluster_centers.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bFTzByrzIdpY","executionInfo":{"status":"ok","timestamp":1682203388062,"user_tz":-330,"elapsed":21,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"ec0b1410-731f-40c9-fdad-0005404cf325"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["(100, 1280)\n"]}]},{"cell_type":"code","execution_count":6,"metadata":{"id":"qTy1cDcFEJl7","outputId":"f715d2da-0497-496f-fd58-17e008b19bb6","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682203443852,"user_tz":-330,"elapsed":55804,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["(49984, 1281)\n"]}],"source":["# load train set embeddings\n","embeddings=np.loadtxt('embeddings_train_efn.csv',delimiter=',')\n","print(embeddings.shape)"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"HV4_xLgxEJl8","executionInfo":{"status":"ok","timestamp":1682203459725,"user_tz":-330,"elapsed":1155,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["# build inverted index\n","index=[]\n","n=0\n","for entry in cluster_centers:\n","  embeddingsList=embeddings[labels==n]\n","  output=[]\n","  for i in range(embeddingsList.shape[0]):\n","    output.append([embeddingsList[i,0],embeddingsList[i,1:]])\n","  index.append([entry,output])\n","  n=n+1"]},{"cell_type":"code","execution_count":9,"metadata":{"id":"GFFL0tLnEJl-","executionInfo":{"status":"ok","timestamp":1682203465363,"user_tz":-330,"elapsed":1882,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["#Saving the index\n","import pickle\n","# Open a file and use dump()\n","with open('clustering_index_efn.pkl', 'wb') as file:\n","      \n","    # A new file will be created\n","    pickle.dump(index, file)"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"nw_e53OsEJl-","executionInfo":{"status":"ok","timestamp":1682203466409,"user_tz":-330,"elapsed":637,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["#Loading the Index Back\n","\n","import pickle\n","  \n","# Open the file in binary mode\n","with open('clustering_index_efn.pkl', 'rb') as file:\n","      \n","    # Call load method to deserialze\n","    INDEX = pickle.load(file)"]},{"cell_type":"code","source":["# save index file to drive\n","!cp 'clustering_index_efn.pkl' '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final'"],"metadata":{"id":"HTRf_YirTaCu","executionInfo":{"status":"ok","timestamp":1682203473332,"user_tz":-330,"elapsed":4946,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"fnHoDvgkHs6e"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1WBYbANAaU_lMj8Eic5MvAQw0VREJveKy","timestamp":1678709140744}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.10"},"vscode":{"interpreter":{"hash":"486e0d5a79acdbfffd563ee7a67a93a5017bd2a4f66495483a69f0245c8a4a6c"}}},"nbformat":4,"nbformat_minor":0}