{"cells":[{"cell_type":"code","source":["# mount drive\n","from google.colab import drive\n","drive.mount('/gdrive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7EeEhonfJcg5","executionInfo":{"status":"ok","timestamp":1682209407423,"user_tz":-330,"elapsed":28637,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"0facf357-4e4f-4203-8fef-b339cb324742"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /gdrive\n"]}]},{"cell_type":"code","source":["# load files\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final/labels_train_hybrid_reduced_70.csv' '/content'\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final/cluster_centers_train_hybrid_reduced_70.csv' '/content'\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final/embeddings_train_hybrid_reduced_70.csv' '/content'"],"metadata":{"id":"7oLR-04_JpgS","executionInfo":{"status":"ok","timestamp":1682210723145,"user_tz":-330,"elapsed":28007,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","execution_count":12,"metadata":{"id":"1ejNRMHcwfMW","executionInfo":{"status":"ok","timestamp":1682210726527,"user_tz":-330,"elapsed":6,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["# import libraries\n","import numpy as np"]},{"cell_type":"code","source":["# load train set clustering labels\n","labels=np.loadtxt('labels_train_hybrid_reduced_70.csv',delimiter=',')\n","print(labels.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5iSuhPYVxdYV","executionInfo":{"status":"ok","timestamp":1682210727245,"user_tz":-330,"elapsed":10,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"84cac03c-84af-41f5-d4a5-04f9b1485a2c"},"execution_count":13,"outputs":[{"output_type":"stream","name":"stdout","text":["(49984,)\n"]}]},{"cell_type":"code","source":["# load train set cluster centers\n","cluster_centers=np.loadtxt('cluster_centers_train_hybrid_reduced_70.csv',delimiter=',')\n","print(cluster_centers.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bFTzByrzIdpY","executionInfo":{"status":"ok","timestamp":1682210728480,"user_tz":-330,"elapsed":8,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"7899f20d-0f52-42fe-81ba-419e4bf2eba1"},"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["(100, 1254)\n"]}]},{"cell_type":"code","execution_count":15,"metadata":{"id":"qTy1cDcFEJl7","outputId":"2918a46e-a8cb-4d58-e561-0a3fb01e26fe","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682210782431,"user_tz":-330,"elapsed":53045,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["(49984, 1255)\n"]}],"source":["# load train set embeddings\n","embeddings=np.loadtxt('embeddings_train_hybrid_reduced_70.csv',delimiter=',')\n","print(embeddings.shape)"]},{"cell_type":"code","execution_count":16,"metadata":{"id":"HV4_xLgxEJl8","executionInfo":{"status":"ok","timestamp":1682210785217,"user_tz":-330,"elapsed":2819,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["# build inverted index\n","index=[]\n","n=0\n","for entry in cluster_centers:\n","  embeddingsList=embeddings[labels==n]\n","  output=[]\n","  for i in range(embeddingsList.shape[0]):\n","    output.append([embeddingsList[i,0],embeddingsList[i,1:]])\n","  index.append([entry,output])\n","  n=n+1"]},{"cell_type":"code","execution_count":17,"metadata":{"id":"GFFL0tLnEJl-","executionInfo":{"status":"ok","timestamp":1682210788530,"user_tz":-330,"elapsed":3318,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["#Saving the index\n","import pickle\n","# Open a file and use dump()\n","with open('clustering_index_hybrid_reduced_70.pkl', 'wb') as file:\n","      \n","    # A new file will be created\n","    pickle.dump(index, file)"]},{"cell_type":"code","execution_count":18,"metadata":{"id":"nw_e53OsEJl-","executionInfo":{"status":"ok","timestamp":1682210788532,"user_tz":-330,"elapsed":13,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["#Loading the Index Back\n","\n","import pickle\n","  \n","# Open the file in binary mode\n","with open('clustering_index_hybrid_reduced_70.pkl', 'rb') as file:\n","      \n","    # Call load method to deserialze\n","    INDEX = pickle.load(file)"]},{"cell_type":"code","source":["# save index file to drive\n","!cp 'clustering_index_hybrid_reduced_70.pkl' '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final'"],"metadata":{"id":"HTRf_YirTaCu","executionInfo":{"status":"ok","timestamp":1682210790822,"user_tz":-330,"elapsed":2301,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"execution_count":19,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1WBYbANAaU_lMj8Eic5MvAQw0VREJveKy","timestamp":1678709140744}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.10"},"vscode":{"interpreter":{"hash":"486e0d5a79acdbfffd563ee7a67a93a5017bd2a4f66495483a69f0245c8a4a6c"}}},"nbformat":4,"nbformat_minor":0}