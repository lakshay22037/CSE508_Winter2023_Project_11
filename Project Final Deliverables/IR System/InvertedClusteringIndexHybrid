{"cells":[{"cell_type":"code","source":["# mount drive\n","from google.colab import drive\n","drive.mount('/gdrive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7EeEhonfJcg5","executionInfo":{"status":"ok","timestamp":1682203191511,"user_tz":-330,"elapsed":24768,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"316d3b4c-1fe5-470a-8ff6-e8d875911d79"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /gdrive\n"]}]},{"cell_type":"code","source":["# load files\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final/labels_train_hybrid.csv' '/content'\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final/cluster_centers_train_hybrid.csv' '/content'\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final/embeddings_train_hybrid.csv' '/content'"],"metadata":{"id":"7oLR-04_JpgS","executionInfo":{"status":"ok","timestamp":1682203238874,"user_tz":-330,"elapsed":37146,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","execution_count":3,"metadata":{"id":"1ejNRMHcwfMW","executionInfo":{"status":"ok","timestamp":1682203238877,"user_tz":-330,"elapsed":61,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["# import libraries\n","import numpy as np"]},{"cell_type":"code","source":["# load train set clustering labels\n","labels=np.loadtxt('labels_train_hybrid.csv',delimiter=',')\n","print(labels.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5iSuhPYVxdYV","executionInfo":{"status":"ok","timestamp":1682203238878,"user_tz":-330,"elapsed":58,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"20bb02d4-0285-4454-df31-5b52033a0171"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["(49984,)\n"]}]},{"cell_type":"code","source":["# load train set cluster centers\n","cluster_centers=np.loadtxt('cluster_centers_train_hybrid.csv',delimiter=',')\n","print(cluster_centers.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bFTzByrzIdpY","executionInfo":{"status":"ok","timestamp":1682203243660,"user_tz":-330,"elapsed":9,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"dca76a74-ad2a-4447-c59b-0c33bb8790e7"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["(100, 1792)\n"]}]},{"cell_type":"code","execution_count":7,"metadata":{"id":"qTy1cDcFEJl7","outputId":"2ff902d9-b76f-4bbc-a6c1-92fa1f7956ff","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682203347128,"user_tz":-330,"elapsed":77778,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["(49984, 1793)\n"]}],"source":["# load train set embeddings\n","embeddings=np.loadtxt('embeddings_train_hybrid.csv',delimiter=',')\n","print(embeddings.shape)"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"HV4_xLgxEJl8","executionInfo":{"status":"ok","timestamp":1682203409308,"user_tz":-330,"elapsed":560,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["# build inverted index\n","index=[]\n","n=0\n","for entry in cluster_centers:\n","  embeddingsList=embeddings[labels==n]\n","  output=[]\n","  for i in range(embeddingsList.shape[0]):\n","    output.append([embeddingsList[i,0],embeddingsList[i,1:]])\n","  index.append([entry,output])\n","  n=n+1"]},{"cell_type":"code","execution_count":9,"metadata":{"id":"GFFL0tLnEJl-","executionInfo":{"status":"ok","timestamp":1682203416841,"user_tz":-330,"elapsed":2468,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["#Saving the index\n","import pickle\n","# Open a file and use dump()\n","with open('clustering_index_hybrid.pkl', 'wb') as file:\n","      \n","    # A new file will be created\n","    pickle.dump(index, file)"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"nw_e53OsEJl-","executionInfo":{"status":"ok","timestamp":1682203419815,"user_tz":-330,"elapsed":3,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["#Loading the Index Back\n","\n","import pickle\n","  \n","# Open the file in binary mode\n","with open('clustering_index_hybrid.pkl', 'rb') as file:\n","      \n","    # Call load method to deserialze\n","    INDEX = pickle.load(file)"]},{"cell_type":"code","source":["# save index file to drive\n","!cp 'clustering_index_hybrid.pkl' '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project Final'"],"metadata":{"id":"HTRf_YirTaCu","executionInfo":{"status":"ok","timestamp":1682203435826,"user_tz":-330,"elapsed":3159,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"58qyaBwAI1B1"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1WBYbANAaU_lMj8Eic5MvAQw0VREJveKy","timestamp":1678709140744}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.10"},"vscode":{"interpreter":{"hash":"486e0d5a79acdbfffd563ee7a67a93a5017bd2a4f66495483a69f0245c8a4a6c"}}},"nbformat":4,"nbformat_minor":0}