{"cells":[{"cell_type":"code","source":["# mount drive\n","from google.colab import drive\n","drive.mount('/gdrive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7EeEhonfJcg5","executionInfo":{"status":"ok","timestamp":1678724371089,"user_tz":-330,"elapsed":55337,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"b55e24d6-b177-4c1e-e428-71597ce9995f"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /gdrive\n"]}]},{"cell_type":"code","source":["# load files\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project/train_labels.csv' '/content'\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project/train_cluster_centers.csv' '/content'\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project/train_embeddings.csv' '/content'"],"metadata":{"id":"7oLR-04_JpgS","executionInfo":{"status":"ok","timestamp":1678724429470,"user_tz":-330,"elapsed":29984,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","execution_count":3,"metadata":{"id":"1ejNRMHcwfMW","executionInfo":{"status":"ok","timestamp":1678724438987,"user_tz":-330,"elapsed":7,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["# import libraries\n","import numpy as np"]},{"cell_type":"code","source":["# load train set clustering labels\n","labels=np.loadtxt('train_labels.csv',delimiter=',')\n","print(labels)\n","print(labels.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5iSuhPYVxdYV","executionInfo":{"status":"ok","timestamp":1678724457902,"user_tz":-330,"elapsed":16,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"1bb8a3a1-2939-4eff-cc86-198f9855afeb"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["[51. 46. 20. ... 69. 33. 66.]\n","(49984,)\n"]}]},{"cell_type":"code","source":["# load train set cluster centers\n","cluster_centers=np.loadtxt('train_cluster_centers.csv',delimiter=',')\n","print(cluster_centers)\n","print(cluster_centers.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bFTzByrzIdpY","executionInfo":{"status":"ok","timestamp":1678724463797,"user_tz":-330,"elapsed":5,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"690a19b8-b8e9-4fa0-f7b5-3c03e14c7271"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["[[ 8.28174800e-02  1.41745061e-02 -8.73458534e-02 ... -2.77698934e-02\n","  -3.56990993e-02 -1.04800045e-01]\n"," [ 2.26238370e-02 -6.59414977e-02  3.27154994e-05 ...  5.97154558e-01\n","  -6.47254586e-02  6.38943911e-02]\n"," [-2.94163674e-02 -7.33928233e-02 -2.11802870e-03 ...  4.64036822e-01\n","  -6.80452138e-02  3.33172977e-02]\n"," ...\n"," [ 1.48251235e-01 -4.12539393e-02  8.32707822e-01 ... -3.91912460e-02\n","  -6.38392121e-02  1.25346199e-01]\n"," [-1.45474672e-02  7.65140355e-02  1.56410128e-01 ...  2.67935514e-01\n","  -2.51886547e-02  3.01035702e-01]\n"," [-2.29375586e-02  2.45062023e-01  7.84010738e-02 ... -9.00382847e-02\n","  -7.65002668e-02  1.98916525e-01]]\n","(100, 1280)\n"]}]},{"cell_type":"code","execution_count":6,"metadata":{"id":"qTy1cDcFEJl7","outputId":"ab8e190e-1ff1-4454-90c7-22aeb1a8ad23","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1678724535970,"user_tz":-330,"elapsed":57529,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["(49984, 1281)\n"]}],"source":["# load train set embeddings\n","embeddings=np.loadtxt('train_embeddings.csv',delimiter=',')\n","print(embeddings.shape)"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"HV4_xLgxEJl8","executionInfo":{"status":"ok","timestamp":1678724543669,"user_tz":-330,"elapsed":535,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["# build inverted index\n","index=[]\n","n=0\n","for entry in cluster_centers:\n","    embeddingsList=embeddings[labels==n]\n","    output=[]\n","    for i in range(embeddingsList.shape[0]):\n","\t    output.append([embeddingsList[i,0],embeddingsList[i,1:]])\n","    index.append([entry,output])\n","    n=n+1"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"GFFL0tLnEJl-","executionInfo":{"status":"ok","timestamp":1678724554070,"user_tz":-330,"elapsed":3191,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["#Saving the index\n","import pickle\n","# Open a file and use dump()\n","with open('clustering_index.pkl', 'wb') as file:\n","      \n","    # A new file will be created\n","    pickle.dump(index, file)"]},{"cell_type":"code","execution_count":9,"metadata":{"id":"nw_e53OsEJl-","executionInfo":{"status":"ok","timestamp":1678724558355,"user_tz":-330,"elapsed":1968,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["#Loading the Index Back\n","\n","import pickle\n","  \n","# Open the file in binary mode\n","with open('clustering_index.pkl', 'rb') as file:\n","      \n","    # Call load method to deserialze\n","    INDEX = pickle.load(file)"]},{"cell_type":"code","source":["# save index file to drive\n","!cp 'clustering_index.pkl' '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project'"],"metadata":{"id":"HTRf_YirTaCu","executionInfo":{"status":"ok","timestamp":1678724564317,"user_tz":-330,"elapsed":845,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"execution_count":10,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1WBYbANAaU_lMj8Eic5MvAQw0VREJveKy","timestamp":1678709140744}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.10"},"vscode":{"interpreter":{"hash":"486e0d5a79acdbfffd563ee7a67a93a5017bd2a4f66495483a69f0245c8a4a6c"}}},"nbformat":4,"nbformat_minor":0}