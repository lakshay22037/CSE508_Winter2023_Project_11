{"cells":[{"cell_type":"code","source":["# mount drive\n","from google.colab import drive\n","drive.mount('/gdrive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7EeEhonfJcg5","executionInfo":{"status":"ok","timestamp":1679656920944,"user_tz":-330,"elapsed":29009,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"d808a752-4176-4957-b587-df9c17f4ccc8"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /gdrive\n"]}]},{"cell_type":"code","source":["# load files\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project/train_labels_hybrid.csv' '/content'\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project/train_cluster_centers_hybrid.csv' '/content'\n","!cp '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project/train_embeddings_hybrid.csv' '/content'"],"metadata":{"id":"7oLR-04_JpgS","executionInfo":{"status":"ok","timestamp":1679656957878,"user_tz":-330,"elapsed":32152,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","execution_count":3,"metadata":{"id":"1ejNRMHcwfMW","executionInfo":{"status":"ok","timestamp":1679656963932,"user_tz":-330,"elapsed":734,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["# import libraries\n","import numpy as np"]},{"cell_type":"code","source":["# load train set clustering labels\n","labels=np.loadtxt('train_labels_hybrid.csv',delimiter=',')\n","print(labels)\n","print(labels.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5iSuhPYVxdYV","executionInfo":{"status":"ok","timestamp":1679656970537,"user_tz":-330,"elapsed":548,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"1f8912b0-b5e7-4324-95ab-99cd23a4a7cc"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["[93. 43. 55. ... 92. 36. 12.]\n","(49984,)\n"]}]},{"cell_type":"code","source":["# load train set cluster centers\n","cluster_centers=np.loadtxt('train_cluster_centers_hybrid.csv',delimiter=',')\n","print(cluster_centers)\n","print(cluster_centers.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bFTzByrzIdpY","executionInfo":{"status":"ok","timestamp":1679656979825,"user_tz":-330,"elapsed":4,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}},"outputId":"ff042fc1-7394-4346-b99c-02ab6edcb1a6"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["[[ 0.09850023  0.00825614 -0.08816688 ...  0.37453246  0.29847983\n","   0.49542338]\n"," [ 0.26336068  0.12058347  0.09856337 ...  0.42243892  0.39474261\n","   0.48607823]\n"," [ 0.00853698  1.39124143 -0.05349527 ...  0.48005694  0.43460619\n","   0.47168937]\n"," ...\n"," [ 0.11515699  0.09727087 -0.00956668 ...  0.41198251  0.42549756\n","   0.48641333]\n"," [ 0.17020926 -0.07844093  1.12429166 ...  0.43052295  0.4007405\n","   0.46342692]\n"," [ 0.08631665  0.68892407  0.13590008 ...  0.45148933  0.4153353\n","   0.47207314]]\n","(100, 1792)\n"]}]},{"cell_type":"code","execution_count":6,"metadata":{"id":"qTy1cDcFEJl7","outputId":"38c42345-542f-4aed-d9bd-b2c5cbb24799","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1679657072469,"user_tz":-330,"elapsed":77929,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["(49984, 1793)\n"]}],"source":["# load train set embeddings\n","embeddings=np.loadtxt('train_embeddings_hybrid.csv',delimiter=',')\n","print(embeddings.shape)"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"HV4_xLgxEJl8","executionInfo":{"status":"ok","timestamp":1679657084568,"user_tz":-330,"elapsed":3,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["# build inverted index\n","index=[]\n","n=0\n","for entry in cluster_centers:\n","    embeddingsList=embeddings[labels==n]\n","    output=[]\n","    for i in range(embeddingsList.shape[0]):\n","\t    output.append([embeddingsList[i,0],embeddingsList[i,1:]])\n","    index.append([entry,output])\n","    n=n+1"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"GFFL0tLnEJl-","executionInfo":{"status":"ok","timestamp":1679657094595,"user_tz":-330,"elapsed":2506,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["#Saving the index\n","import pickle\n","# Open a file and use dump()\n","with open('clustering_index_hybrid.pkl', 'wb') as file:\n","      \n","    # A new file will be created\n","    pickle.dump(index, file)"]},{"cell_type":"code","execution_count":9,"metadata":{"id":"nw_e53OsEJl-","executionInfo":{"status":"ok","timestamp":1679657099817,"user_tz":-330,"elapsed":1250,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"outputs":[],"source":["#Loading the Index Back\n","\n","import pickle\n","  \n","# Open the file in binary mode\n","with open('clustering_index_hybrid.pkl', 'rb') as file:\n","      \n","    # Call load method to deserialze\n","    INDEX = pickle.load(file)"]},{"cell_type":"code","source":["# save index file to drive\n","!cp 'clustering_index_hybrid.pkl' '/gdrive/MyDrive/Colab Notebooks/Information Retrieval CSE508/Project'"],"metadata":{"id":"HTRf_YirTaCu","executionInfo":{"status":"ok","timestamp":1679657109640,"user_tz":-330,"elapsed":2619,"user":{"displayName":"Pijush Bhuyan","userId":"04528471696330882279"}}},"execution_count":10,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1WBYbANAaU_lMj8Eic5MvAQw0VREJveKy","timestamp":1678709140744}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.10"},"vscode":{"interpreter":{"hash":"486e0d5a79acdbfffd563ee7a67a93a5017bd2a4f66495483a69f0245c8a4a6c"}}},"nbformat":4,"nbformat_minor":0}